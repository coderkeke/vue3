import"./PlusOutlined-Bo95f7KH.js";import"./useState-DIKhPmwo.js";import{n as e,t}from"./DynamicForm-uMartnT8.js";import{t as n}from"./table-D-JpuCER.js";import"./select-CC1ZklT2.js";import"./vnode-DGJKgt6h.js";import"./style-CMMP8PqQ.js";import"./wave-DTKiIBeV.js";import"./useRefs-DpNy2-fv.js";import"./Col-Czvnh7xb.js";import"./useBreakpoint-DkUPWbhR.js";import{t as r}from"./button-CE79zmeX.js";import"./dropdown-OSSEf5kh.js";import"./RightOutlined-5dInGagU.js";import"./slider-DfcFv3gR.js";import"./DownloadOutlined-C-tHFd-P.js";import"./DoubleRightOutlined-CBdb2pqL.js";import"./useFlexGapSupport-gkIuc-8z.js";import"./switch-BoSjhwDX.js";import{n as i}from"./es-Phweb5yZ.js";import"./spin-C_hZvxTZ.js";import"./pagination-DLViZIcK.js";import"./ArrowRightOutlined-DenqRJlU.js";import{t as a}from"./space-Cukkb_Tx.js";import"./WarningFilled-lxl7VMMC.js";import"./FolderOutlined-C_Dkt70q.js";import{An as o,Nn as s,Wn as c,Xn as l,Yn as u,_n as d,bn as f,mn as p,o as m,rr as h,vn as g,yn as _}from"./index-IbQU_uUx.js";import{t as v}from"./_plugin-vue_export-helper-t17CR7cw.js";import{i as y,n as b,r as x}from"./analysis-Cha_teIo.js";var S={class:`page-container`},C={style:{"text-align":`right`}},w={class:`operation-bar`},T={class:`table-container`},E=v(f({name:`HiddenDangerEntry`,__name:`index`,setup(f){let v=l(!1),E=l(!1),D=l([]),O=l({}),k=l([]),A=l([]),j=u({total:0,current:1,pageSize:10,showSizeChanger:!0,showQuickJumper:!0}),M=l(void 0),N=async()=>{v.value=!0;try{let e=(await b()).data;if(e&&e.success){let t=[];e.groupColumns.forEach(n=>{let r=e.columnStats[n]||[];t.push({field:n,label:n,component:`Select`,componentProps:{options:r.map(e=>{let t=e[n];return{label:`${t} (${e.count})`,value:t}}),showSearch:!0,allowClear:!0,mode:`multiple`,maxTagCount:1,placeholder:`请选择`},colProps:{span:6,xs:24,sm:12,md:8,lg:6,xl:6}})}),t.push({field:`action`,label:``,slot:`action`,formItemProps:{wrapperCol:{span:24}},colProps:{span:6,xs:24,sm:12,md:8,lg:6,xl:6}}),D.value=t,e.allColumns&&(A.value=e.allColumns.map(e=>({title:e,dataIndex:e,key:e,width:150,ellipsis:!0})))}}catch(e){console.error(`获取筛选条件失败:`,e)}finally{v.value=!1}},P=async(e=1,t=10)=>{E.value=!0;try{let n=(e-1)*t,r=(await x({...M.value,limit:t,offset:n})).data;r&&r.data?(k.value=r.data,r.pagination?j.total=r.pagination.totalCount||0:j.total=0):(k.value=[],j.total=0),j.current=e,j.pageSize=t}catch(e){console.error(`获取表格数据失败:`,e)}finally{E.value=!1}},F=()=>{let e={};Object.keys(O.value).forEach(t=>{let n=O.value[t];if(n!=null&&n!==``){if(Array.isArray(n)&&n.length===0)return;e[t]=n}}),M.value=e,P(1,j.pageSize)},I=()=>{Object.keys(O.value).forEach(e=>{O.value[e]=void 0}),M.value=void 0,F()},L=e=>{P(e.current||1,e.pageSize||10)},R=async e=>{let{file:t,onSuccess:n,onError:r}=e;try{await y(t),m.success(`导入成功`),n(),P(1,j.pageSize)}catch(e){console.error(`导入失败:`,e),m.error(`导入失败`),r(e)}};return o(()=>{N(),P()}),(o,l)=>{let u=r,f=a,m=e,v=n;return s(),d(`div`,S,[_(t,{model:O.value,schemas:D.value,"row-props":{gutter:[16,16]}},{action:c(()=>[p(`div`,C,[_(f,null,{default:c(()=>[_(u,{type:`primary`,onClick:F},{default:c(()=>[...l[0]||=[g(`查询`,-1)]]),_:1}),_(u,{onClick:I},{default:c(()=>[...l[1]||=[g(`重置`,-1)]]),_:1})]),_:1})])]),_:1},8,[`model`,`schemas`]),p(`div`,w,[_(f,null,{default:c(()=>[_(m,{name:`file`,"show-upload-list":!1,"custom-request":R,accept:`.xlsx, .xls`},{default:c(()=>[_(u,{type:`primary`},{default:c(()=>[_(h(i)),l[2]||=g(` 导入Excel `,-1)]),_:1})]),_:1})]),_:1})]),p(`div`,T,[_(v,{columns:A.value,"data-source":k.value,loading:E.value,pagination:j,"row-key":`id`,scroll:{x:1e3},onChange:L},null,8,[`columns`,`data-source`,`loading`,`pagination`])])])}}}),[[`__scopeId`,`data-v-88267cb0`]]);export{E as default};